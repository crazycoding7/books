<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Jetpack | 知鱼之乐@Android</title>
    <meta name="generator" content="VuePress 1.8.0">
    
    <meta name="description" content="Just playing around 1">
    
    <link rel="preload" href="/assets/css/0.styles.fab77d47.css" as="style"><link rel="preload" href="/assets/js/app.c07a8530.js" as="script"><link rel="preload" href="/assets/js/2.21cd6422.js" as="script"><link rel="preload" href="/assets/js/63.00e66735.js" as="script"><link rel="prefetch" href="/assets/js/10.8f5db795.js"><link rel="prefetch" href="/assets/js/11.81a0383e.js"><link rel="prefetch" href="/assets/js/12.7adcbe04.js"><link rel="prefetch" href="/assets/js/13.96cea490.js"><link rel="prefetch" href="/assets/js/14.4524dd73.js"><link rel="prefetch" href="/assets/js/15.97e45047.js"><link rel="prefetch" href="/assets/js/16.89d9e937.js"><link rel="prefetch" href="/assets/js/17.ff826fee.js"><link rel="prefetch" href="/assets/js/18.b4a77896.js"><link rel="prefetch" href="/assets/js/19.b9a1c3fa.js"><link rel="prefetch" href="/assets/js/20.3792e9b9.js"><link rel="prefetch" href="/assets/js/21.37072d83.js"><link rel="prefetch" href="/assets/js/22.52a70991.js"><link rel="prefetch" href="/assets/js/23.25384ea3.js"><link rel="prefetch" href="/assets/js/24.7386311f.js"><link rel="prefetch" href="/assets/js/25.7da2dc83.js"><link rel="prefetch" href="/assets/js/26.ef1aa4f4.js"><link rel="prefetch" href="/assets/js/27.6ad2a843.js"><link rel="prefetch" href="/assets/js/28.2ccb2aa2.js"><link rel="prefetch" href="/assets/js/29.2f75afc4.js"><link rel="prefetch" href="/assets/js/3.4466197b.js"><link rel="prefetch" href="/assets/js/30.4698274c.js"><link rel="prefetch" href="/assets/js/31.4feec2ae.js"><link rel="prefetch" href="/assets/js/32.324c08a7.js"><link rel="prefetch" href="/assets/js/33.cf0bd43e.js"><link rel="prefetch" href="/assets/js/34.6f26bc88.js"><link rel="prefetch" href="/assets/js/35.982a71fe.js"><link rel="prefetch" href="/assets/js/36.0847dd4d.js"><link rel="prefetch" href="/assets/js/37.6f57ca09.js"><link rel="prefetch" href="/assets/js/38.3b55b093.js"><link rel="prefetch" href="/assets/js/39.27b60453.js"><link rel="prefetch" href="/assets/js/4.c5a84081.js"><link rel="prefetch" href="/assets/js/40.cf4bac98.js"><link rel="prefetch" href="/assets/js/41.76c8f541.js"><link rel="prefetch" href="/assets/js/42.16644abe.js"><link rel="prefetch" href="/assets/js/43.b7dbb0ea.js"><link rel="prefetch" href="/assets/js/44.5d0cca22.js"><link rel="prefetch" href="/assets/js/45.8c99e4f7.js"><link rel="prefetch" href="/assets/js/46.fbfb7b80.js"><link rel="prefetch" href="/assets/js/47.d9084297.js"><link rel="prefetch" href="/assets/js/48.8d52f361.js"><link rel="prefetch" href="/assets/js/49.e3d402c6.js"><link rel="prefetch" href="/assets/js/5.2f9e54c1.js"><link rel="prefetch" href="/assets/js/50.3d153b3a.js"><link rel="prefetch" href="/assets/js/51.7a4172c3.js"><link rel="prefetch" href="/assets/js/52.05dc5c54.js"><link rel="prefetch" href="/assets/js/53.4927573e.js"><link rel="prefetch" href="/assets/js/54.098ae63d.js"><link rel="prefetch" href="/assets/js/55.019110b1.js"><link rel="prefetch" href="/assets/js/56.5fca19ec.js"><link rel="prefetch" href="/assets/js/57.b149ba38.js"><link rel="prefetch" href="/assets/js/58.82435927.js"><link rel="prefetch" href="/assets/js/59.d1a74538.js"><link rel="prefetch" href="/assets/js/6.77e9249b.js"><link rel="prefetch" href="/assets/js/60.a254b2ef.js"><link rel="prefetch" href="/assets/js/61.ddf4f6f7.js"><link rel="prefetch" href="/assets/js/62.aa46eb13.js"><link rel="prefetch" href="/assets/js/64.e29273a7.js"><link rel="prefetch" href="/assets/js/65.42042661.js"><link rel="prefetch" href="/assets/js/66.0c4d6dcb.js"><link rel="prefetch" href="/assets/js/67.d1aaa55b.js"><link rel="prefetch" href="/assets/js/68.6e490c7d.js"><link rel="prefetch" href="/assets/js/69.7caa4557.js"><link rel="prefetch" href="/assets/js/7.13bfa8a9.js"><link rel="prefetch" href="/assets/js/70.0049ace5.js"><link rel="prefetch" href="/assets/js/71.cf3c7b2d.js"><link rel="prefetch" href="/assets/js/72.04961f5d.js"><link rel="prefetch" href="/assets/js/73.08ea66ac.js"><link rel="prefetch" href="/assets/js/74.c0d87eba.js"><link rel="prefetch" href="/assets/js/75.8dc1b0c9.js"><link rel="prefetch" href="/assets/js/76.d6c03eff.js"><link rel="prefetch" href="/assets/js/77.f2fa2f17.js"><link rel="prefetch" href="/assets/js/78.b70c792f.js"><link rel="prefetch" href="/assets/js/79.67caf1fc.js"><link rel="prefetch" href="/assets/js/8.99e19efb.js"><link rel="prefetch" href="/assets/js/80.e6a02ece.js"><link rel="prefetch" href="/assets/js/81.d1caaf95.js"><link rel="prefetch" href="/assets/js/82.34a5c1cb.js"><link rel="prefetch" href="/assets/js/83.7977a717.js"><link rel="prefetch" href="/assets/js/84.76de2a97.js"><link rel="prefetch" href="/assets/js/85.72a2a0bf.js"><link rel="prefetch" href="/assets/js/86.add5d520.js"><link rel="prefetch" href="/assets/js/87.f2050760.js"><link rel="prefetch" href="/assets/js/88.898ccfe8.js"><link rel="prefetch" href="/assets/js/89.184558ad.js"><link rel="prefetch" href="/assets/js/9.84445d1a.js"><link rel="prefetch" href="/assets/js/90.1962915a.js"><link rel="prefetch" href="/assets/js/91.8e89c409.js"><link rel="prefetch" href="/assets/js/92.c4b9701b.js"><link rel="prefetch" href="/assets/js/93.8cbf1116.js"><link rel="prefetch" href="/assets/js/94.28127935.js"><link rel="prefetch" href="/assets/js/95.1b0e238c.js"><link rel="prefetch" href="/assets/js/96.9de0c256.js"><link rel="prefetch" href="/assets/js/97.7caff6ea.js"><link rel="prefetch" href="/assets/js/98.483c29bd.js"><link rel="prefetch" href="/assets/js/99.0b00b1e1.js">
    <link rel="stylesheet" href="/assets/css/0.styles.fab77d47.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">知鱼之乐@Android</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="/guide/" class="nav-link">
  Guide
</a></div><div class="nav-item"><a href="https://google.com" target="_blank" rel="noopener noreferrer" class="nav-link external">
  External
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="/guide/" class="nav-link">
  Guide
</a></div><div class="nav-item"><a href="https://google.com" target="_blank" rel="noopener noreferrer" class="nav-link external">
  External
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><a href="/Android/01基础机制/" class="sidebar-heading clickable open"><span>Android基础</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/Android/01基础机制/1.Android系统启动流程.html" class="sidebar-link">Android系统启动过程</a></li><li><a href="/Android/01基础机制/2.Binder进程通信机制.html" class="sidebar-link">Binder进程通信机制</a></li></ul></section></li><li><section class="sidebar-group depth-0"><a href="/Tools/" class="sidebar-heading clickable"><span>Tools</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/Tools/1.Mac开发快捷键大全.html" class="sidebar-link">Mac开发快捷键大全</a></li><li><a href="/Tools/2.翻墙工具指南.html" class="sidebar-link">翻墙工具指南</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h3 id="jetpack"><a href="#jetpack" class="header-anchor">#</a> Jetpack</h3> <p>[TOC]</p> <h4 id="_1-介绍"><a href="#_1-介绍" class="header-anchor">#</a> 1. 介绍</h4> <p>​	Android Jetpack组件是库的集合，这些库是为协同工作而构建的，不够也可以单独使用，同时利用Kotlin语言的特性帮助您提高工作效率。</p> <img src="images/arch_jetpack.png" alt="jetpact" style="zoom:50%;"> <h4 id="_2-android-ktx库概要"><a href="#_2-android-ktx库概要" class="header-anchor">#</a> 2. Android KTX库概要</h4> <p>​	是包含在Android Jetpack及其它Android库中的一组Kotlin扩展程序。可以为Jetpack、Android平台提供简洁的的API。利用了Kotlin语言功能：<strong>扩展函数</strong>、扩展属性、<strong>Lambda</strong>、命名参数、参数默认值、协程。</p> <p>例如：</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">//例子1： Android代码</span>
sharedPreferences
        <span class="token punctuation">.</span><span class="token function">edit</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment">// create an Editor</span>
        <span class="token punctuation">.</span><span class="token function">putBoolean</span><span class="token punctuation">(</span><span class="token string">&quot;key&quot;</span><span class="token punctuation">,</span> value<span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// write to disk asynchronously</span>
<span class="token comment">// KTX库代码</span>
sharedPreferences<span class="token punctuation">.</span>edit <span class="token punctuation">{</span> <span class="token function">putBoolean</span><span class="token punctuation">(</span><span class="token string">&quot;key&quot;</span><span class="token punctuation">,</span> value<span class="token punctuation">)</span> <span class="token punctuation">}</span>
</code></pre></div><h4 id="_3-core-ktx库"><a href="#_3-core-ktx库" class="header-anchor">#</a> 3. Core KTX库</h4> <div class="language-java extra-class"><pre class="language-java"><code>dependencies <span class="token punctuation">{</span>
    <span class="token comment">// 核心库 </span>
    implementation <span class="token string">&quot;androidx.core:core-ktx:1.3.0&quot;</span>
    <span class="token comment">// 集合扩展库(ArrayMap、Lrccache..)  </span>
    implementation <span class="token string">&quot;androidx.collection:collection-ktx:1.1.0&quot;</span>
    <span class="token comment">// fragment扩展库  </span>
    implementation <span class="token string">&quot;androidx.fragment:fragment-ktx:1.2.4&quot;</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="_4-lifcycle-ktx"><a href="#_4-lifcycle-ktx" class="header-anchor">#</a> 4. Lifcycle KTX</h4> <ol><li>介绍</li></ol> <p><strong>赋予组件感知生命周期的能力。</strong>。Lifecycle KTX 为每个 <a href="https://developer.android.google.cn/topic/libraries/architecture/lifecycle" target="_blank" rel="noopener noreferrer"><code>Lifecycle</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 对象定义一个 <code>LifecycleScope</code>。在此范围内启动的协程会在 <code>Lifecycle</code> 被销毁时取消。</p> <div class="language-java extra-class"><pre class="language-java"><code>    dependencies <span class="token punctuation">{</span>
        implementation <span class="token string">&quot;androidx.lifecycle:lifecycle-runtime-ktx:2.2.0&quot;</span>
    <span class="token punctuation">}</span>
</code></pre></div><ol start="2"><li>初级例子：</li></ol> <div class="language-java extra-class"><pre class="language-java"><code> <span class="token comment">// 使组件本身具有生命周期感知能力，避免在Activity生命周期中写过多代码。</span>
 <span class="token keyword">class</span> <span class="token class-name">MyActivity</span> <span class="token operator">:</span> <span class="token class-name">AppCompatActivity</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">private</span> lateinit <span class="token keyword">var</span> myLocationListener<span class="token operator">:</span> <span class="token class-name">MyLocationListener</span>
        override fun <span class="token function">onCreate</span><span class="token punctuation">(</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            myLocationListener <span class="token operator">=</span> <span class="token class-name">MyLocationListener</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> lifecycle<span class="token punctuation">)</span> <span class="token punctuation">{</span> location <span class="token operator">-&gt;</span>
                <span class="token comment">// update UI</span>
            <span class="token punctuation">}</span>
            <span class="token class-name">Util</span><span class="token punctuation">.</span>checkUserStatus <span class="token punctuation">{</span> result <span class="token operator">-&gt;</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>result<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    myLocationListener<span class="token punctuation">.</span><span class="token function">enable</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
 internal <span class="token keyword">class</span> <span class="token class-name">MyLocationListener</span><span class="token punctuation">(</span>
            <span class="token keyword">private</span> val context<span class="token operator">:</span> <span class="token class-name">Context</span><span class="token punctuation">,</span>
            <span class="token keyword">private</span> val lifecycle<span class="token operator">:</span> <span class="token class-name">Lifecycle</span><span class="token punctuation">,</span>
            <span class="token keyword">private</span> val callback<span class="token operator">:</span> <span class="token punctuation">(</span><span class="token class-name">Location</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token class-name">Unit</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">private</span> <span class="token keyword">var</span> enabled <span class="token operator">=</span> <span class="token boolean">false</span>
        <span class="token annotation punctuation">@OnLifecycleEvent</span><span class="token punctuation">(</span><span class="token class-name">Lifecycle<span class="token punctuation">.</span>Event</span><span class="token punctuation">.</span>ON_START<span class="token punctuation">)</span>
        fun <span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>enabled<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token comment">// connect</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        fun <span class="token function">enable</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            enabled <span class="token operator">=</span> <span class="token boolean">true</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>lifecycle<span class="token punctuation">.</span>currentState<span class="token punctuation">.</span><span class="token function">isAtLeast</span><span class="token punctuation">(</span><span class="token class-name">Lifecycle<span class="token punctuation">.</span>State</span><span class="token punctuation">.</span>STARTED<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token comment">// connect if not connected</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token annotation punctuation">@OnLifecycleEvent</span><span class="token punctuation">(</span><span class="token class-name">Lifecycle<span class="token punctuation">.</span>Event</span><span class="token punctuation">.</span>ON_STOP<span class="token punctuation">)</span>
        fun <span class="token function">stop</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// disconnect if connected</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
</code></pre></div><ol start="3"><li>生命周期感知型组件的最佳做法</li></ol> <ul><li><p>使界面控制器（Activity 和 Fragment）尽可能保持精简。它们不应试图获取自己的数据，而应使用 <a href="https://developer.android.google.cn/reference/androidx/lifecycle/ViewModel" target="_blank" rel="noopener noreferrer"><code>ViewModel</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 执行此操作，并观察 <a href="https://developer.android.google.cn/reference/androidx/lifecycle/LiveData" target="_blank" rel="noopener noreferrer"><code>LiveData</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 对象以将更改体现到视图中。</p></li> <li><p>设法编写数据驱动型界面，对于此类界面，界面控制器的责任是随着数据更改而更新视图，或者将用户操作通知给 <a href="https://developer.android.google.cn/reference/androidx/lifecycle/ViewModel" target="_blank" rel="noopener noreferrer"><code>ViewModel</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>。</p></li> <li><p>将数据逻辑放在 <a href="https://developer.android.google.cn/reference/androidx/lifecycle/ViewModel" target="_blank" rel="noopener noreferrer"><code>ViewModel</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 类中。<a href="https://developer.android.google.cn/reference/androidx/lifecycle/ViewModel" target="_blank" rel="noopener noreferrer"><code>ViewModel</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 应充当界面控制器与应用其余部分之间的连接器。不过要注意，<a href="https://developer.android.google.cn/reference/androidx/lifecycle/ViewModel" target="_blank" rel="noopener noreferrer"><code>ViewModel</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 不负责获取数据（例如，从网络获取）。<a href="https://developer.android.google.cn/reference/androidx/lifecycle/ViewModel" target="_blank" rel="noopener noreferrer"><code>ViewModel</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 应调用相应的组件来获取数据，然后将结果提供给界面控制器。</p></li> <li><p>使用 <a href="https://developer.android.google.cn/topic/libraries/data-binding" target="_blank" rel="noopener noreferrer">Data Binding<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 在视图与界面控制器之间维持干净的接口。这样一来，您可以使视图更具声明性，并尽量减少需要在 Activity 和 Fragment 中编写的更新代码。如果您更愿意使用 Java 编程语言执行此操作，请使用诸如 <a href="http://jakewharton.github.io/butterknife/" target="_blank" rel="noopener noreferrer">Butter Knife<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 之类的库，以避免样板代码并实现更好的抽象化。</p></li> <li><p>如果界面很复杂，不妨考虑创建 <a href="http://www.gwtproject.org/articles/mvp-architecture.html#presenter" target="_blank" rel="noopener noreferrer">presenter<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 类来处理界面的修改。这可能是一项艰巨的任务，但这样做可使界面组件更易于测试。</p></li> <li><p>避免在 <a href="https://developer.android.google.cn/reference/androidx/lifecycle/ViewModel" target="_blank" rel="noopener noreferrer"><code>ViewModel</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 中引用 <code>View</code> 或 <code>Activity</code> 上下文。如果 <code>ViewModel</code> 存在的时间比 Activity 更长（在配置更改的情况下），Activity 将泄露并且不会由垃圾回收器妥善处置。</p></li> <li><p>使用 <a href="https://developer.android.google.cn/topic/libraries/architecture/coroutines" target="_blank" rel="noopener noreferrer">Kotlin 协程<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>管理长时间运行的任务和其他可以异步运行的操作。</p></li> <li><p>原理</p></li></ul> <ol><li><p><code>ComponentActivity implements LifecycleOwner</code>接口中的<code>Lifecycle getLifecycle();</code>方法。</p> <div class="language-java extra-class"><pre class="language-java"><code>  <span class="token comment">// init</span>
	<span class="token keyword">public</span> <span class="token class-name">ComponentActivity</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">Lifecycle</span> lifecycle <span class="token operator">=</span> <span class="token function">getLifecycle</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">getLifecycle</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">addObserver</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">LifecycleEventObserver</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token annotation punctuation">@Override</span>
            <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onStateChanged</span><span class="token punctuation">(</span><span class="token annotation punctuation">@NonNull</span> <span class="token class-name">LifecycleOwner</span> source<span class="token punctuation">,</span>
                    <span class="token annotation punctuation">@NonNull</span> <span class="token class-name">Lifecycle<span class="token punctuation">.</span>Event</span> event<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>event <span class="token operator">==</span> <span class="token class-name">Lifecycle<span class="token punctuation">.</span>Event</span><span class="token punctuation">.</span>ON_DESTROY<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">isChangingConfigurations</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                        <span class="token function">getViewModelStore</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

  <span class="token comment">//2. LifecycleRegistry 初始化  </span>
  <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">WeakReference</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">LifecycleOwner</span><span class="token punctuation">&gt;</span></span> mLifecycleOwner<span class="token punctuation">;</span>
	<span class="token keyword">public</span> <span class="token class-name">LifecycleRegistry</span><span class="token punctuation">(</span><span class="token annotation punctuation">@NonNull</span> <span class="token class-name">LifecycleOwner</span> provider<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  	mLifecycleOwner <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">WeakReference</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span>provider<span class="token punctuation">)</span><span class="token punctuation">;</span>
  	mState <span class="token operator">=</span> INITIALIZED<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
</code></pre></div></li> <li><p>让activity生命周期与lifecycle生命周期绑定</p></li></ol> <img src="images/jetpack-lifecycle-states.png" alt="lifecycle" style="zoom:80%;"> <h4 id="_5-viewmodel-ktx"><a href="#_5-viewmodel-ktx" class="header-anchor">#</a> 5. ViewModel KTX</h4> <ol><li><a href="https://developer.android.google.cn/reference/androidx/lifecycle/ViewModel" target="_blank" rel="noopener noreferrer"><code>ViewModel</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 类旨在以注重生命周期的方式存储和管理界面相关的数据。<a href="https://developer.android.google.cn/reference/androidx/lifecycle/ViewModel" target="_blank" rel="noopener noreferrer"><code>ViewModel</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 类让数据可在发生屏幕旋转等配置更改后继续留存。</li> <li>另一个问题是，界面控制器经常需要进行异步调用，这些调用可能需要一些时间才能返回结果。界面控制器需要管理这些调用，并确保系统在其销毁后清理这些调用以避免潜在的内存泄露。</li></ol> <p>ViewModel KTX 库提供了一个 <code>viewModelScope()</code> 函数，可让您更轻松地从 <code>ViewModel</code> 启动<a href="https://developer.android.google.cn/kotlin/coroutines" target="_blank" rel="noopener noreferrer">协程<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>。<a href="https://kotlin.github.io/kotlinx.coroutines/kotlinx-coroutines-core/kotlinx.coroutines/-coroutine-scope/" target="_blank" rel="noopener noreferrer"><code>CoroutineScope</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 绑定至 <code>Dispatchers.Main</code>，并且会在清除 <code>ViewModel</code> 后自动取消。您可以使用 <code>viewModelScope()</code>，而无需为每个 <code>ViewModel</code> 创建一个新范围。</p> <div class="language-java extra-class"><pre class="language-java"><code>dependencies <span class="token punctuation">{</span>
        implementation <span class="token string">&quot;androidx.lifecycle:lifecycle-viewmodel-ktx:2.2.0&quot;</span>
<span class="token punctuation">}</span>
<span class="token keyword">class</span> <span class="token class-name">MainViewModel</span> <span class="token operator">:</span> <span class="token class-name">ViewModel</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// Make a network request without blocking the UI thread</span>
    <span class="token keyword">private</span> fun <span class="token function">makeNetworkRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// launch a coroutine in viewModelScope</span>
        viewModelScope<span class="token punctuation">.</span>launch  <span class="token punctuation">{</span>
            remoteApi<span class="token punctuation">.</span><span class="token function">slowFetch</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// No need to override onCleared()</span>
<span class="token punctuation">}</span>
</code></pre></div><ul><li><p>原理</p> <ol><li><p>利用map数据结构存储viewModel，key-value：包名:viewmodel对象；</p></li> <li><p>Activity基类ComponentActivity中初始化map(ViewModelStore)，销毁时自动clear。Activity:viewModel = 1:1关系。</p></li></ol></li></ul> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ViewModelStore</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">ViewModel</span><span class="token punctuation">&gt;</span></span> mMap <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">final</span> <span class="token keyword">void</span> <span class="token function">put</span><span class="token punctuation">(</span><span class="token class-name">String</span> key<span class="token punctuation">,</span> <span class="token class-name">ViewModel</span> viewModel<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">ViewModel</span> oldViewModel <span class="token operator">=</span> mMap<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> viewModel<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>oldViewModel <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            oldViewModel<span class="token punctuation">.</span><span class="token function">onCleared</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">final</span> <span class="token class-name">ViewModel</span> <span class="token function">get</span><span class="token punctuation">(</span><span class="token class-name">String</span> key<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> mMap<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token class-name">Set</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> <span class="token function">keys</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">HashSet</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span>mMap<span class="token punctuation">.</span><span class="token function">keySet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token keyword">final</span> <span class="token keyword">void</span> <span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">ViewModel</span> vm <span class="token operator">:</span> mMap<span class="token punctuation">.</span><span class="token function">values</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            vm<span class="token punctuation">.</span><span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        mMap<span class="token punctuation">.</span><span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="_6-livedata-ktx"><a href="#_6-livedata-ktx" class="header-anchor">#</a> 6. LiveData KTX</h4> <ol><li><p>介绍</p> <p>使用 LiveData 时，您可能需要异步计算值。例如，您可能需要检索用户的偏好设置并将其传送给界面。在这些情况下，LiveData KTX 可提供一个 <code>liveData</code> 构建器函数，该函数会调用 <code>suspend</code> 函数，并将结果作为 <code>LiveData</code> 对象传送。</p> <div class="language-java extra-class"><pre class="language-java"><code>     dependencies <span class="token punctuation">{</span>
        implementation <span class="token string">&quot;androidx.lifecycle:lifecycle-livedata-ktx:2.2.0&quot;</span>
    <span class="token punctuation">}</span>
</code></pre></div></li> <li><p>例子</p> <p>在以下示例中，<code>loadUser()</code> 是在其他地方声明的 suspend 函数。 您可以使用 <code>liveData</code> 构建器函数异步调用 <code>loadUser()</code>，然后使用 <code>emit()</code> 来发出结果：</p> <div class="language-java extra-class"><pre class="language-java"><code>val user<span class="token operator">:</span> <span class="token class-name">LiveData</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">User</span><span class="token punctuation">&gt;</span></span> <span class="token operator">=</span> liveData <span class="token punctuation">{</span>
    val data <span class="token operator">=</span> database<span class="token punctuation">.</span><span class="token function">loadUser</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// loadUser is a suspend function.</span>
    <span class="token function">emit</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div></li></ol> <h4 id="_7-room-ktx"><a href="#_7-room-ktx" class="header-anchor">#</a> 7. Room KTX</h4> <p>​	Room 扩展程序增加了对数据库事务的协程支持。</p> <div class="language-java extra-class"><pre class="language-java"><code>dependencies <span class="token punctuation">{</span>
    implementation <span class="token string">&quot;androidx.room:room-ktx:2.2.5&quot;</span>
<span class="token punctuation">}</span>

<span class="token annotation punctuation">@Query</span><span class="token punctuation">(</span><span class="token string">&quot;SELECT * FROM Users&quot;</span><span class="token punctuation">)</span>
suspend fun <span class="token function">getUsers</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">User</span><span class="token punctuation">&gt;</span></span>
<span class="token annotation punctuation">@Query</span><span class="token punctuation">(</span><span class="token string">&quot;SELECT * FROM Users&quot;</span><span class="token punctuation">)</span>
fun <span class="token function">getUsers</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token class-name">Flow</span><span class="token operator">&lt;</span><span class="token class-name">List</span><span class="token operator">&lt;</span><span class="token class-name">User</span>
  
</code></pre></div><h4 id="_8-navigation-ktx"><a href="#_8-navigation-ktx" class="header-anchor">#</a> 8. Navigation KTX</h4> <p>​	导航组件.</p> <ul><li>参考</li></ul> <p><a href="https://github.com/hegaojian/JetpackMvvm" target="_blank" rel="noopener noreferrer">1. JetpackMvvm<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p><a href="https://github.com/KunMinX/Jetpack-MVVM-Best-Practice" target="_blank" rel="noopener noreferrer">2. Jetpack-MVVM-Best-Practice<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></div> <footer class="page-edit"><!----> <!----></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.c07a8530.js" defer></script><script src="/assets/js/2.21cd6422.js" defer></script><script src="/assets/js/63.00e66735.js" defer></script>
  </body>
</html>
